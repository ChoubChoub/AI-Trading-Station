# HFT Memory Optimization - Phase 1 Addition
# Add to existing redis-hft.conf

################################## HFT MEMORY OPTIMIZATION ###############
# Phase 1: Huge pages and memory locking for ultra-low latency

# Enable huge pages for better memory performance (requires system huge pages)
# This reduces TLB misses and provides more predictable memory access
# Set in systemd override: THP_ENABLED=always

# Memory locking to prevent swapping (critical for HFT)
# Prevents memory pages from being swapped to disk
# Combined with systemd LimitMEMLOCK=infinity
# Note: Redis doesn't have direct hugepage config, relies on system/glibc

# Memory allocation optimization for HFT workloads
# Single malloc arena reduces fragmentation and contention
# Set in systemd override: MALLOC_ARENA_MAX=1

# Additional memory-related optimizations
# Disable memory overcommit to ensure available memory
# This is system-wide and should be carefully considered
# sysctl vm.overcommit_memory=2 (optional, needs evaluation)

################################## PERFORMANCE TUNING ####################
# Enhanced settings for Phase 1 memory optimization

# Reduce memory fragmentation
activedefrag yes
active-defrag-ignore-bytes 100mb
active-defrag-threshold-lower 10
active-defrag-threshold-upper 100

# Memory sampling for better eviction decisions
maxmemory-samples 10

# Background saving disabled for HFT (already set)
# save ""
# appendonly no

################################## END PHASE 1 #########################